{
  "hash": "8d56791252717ce54c916947a42e6602",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualization\"\nsubtitle: \"\"\nauthor: \"Amaury & Vincent\"\nfooter: \"[Home](../index.qmd)\"\nlogo: \"../img/logos/phi.svg\"\nformat: \n  revealjs:\n    theme: ../slides.scss\n    transition: none\n    slide-number: true\n    center-title-slide: true\n\nexecute:\n  freeze: auto\n---\n\n\n\n# Visualization\n<font style=\"color:blue; font-weight:bold;\">1. graphics: Good & bad practices</font>  \n<font color=\"gray\">2. individual graphics with ggplot</font>  \n<font color=\"gray\">3. Focus on heatmaps</font>  \n<font color=\"gray\">4. Plot composition</font>  \n<font color=\"gray\">5. some level of automation</font>  \n\n<!--\n- published graphics assessment  \n- Visualisation good practices  \n- Pratice : \"clean\" a graph \n-->\n \n\n## What and why ?\nA scientific visualization is a graphical interface between **people** and **data**.  \n- There are **many** possible graphics for the **same** data.  \n- Different **people** perceive theses graphics differently.  \n<br />\nAn advanced graph :  \n- Conveys **complex** information **clearly**  \n- Integrates multiple layers of **information**  \n- Is **reproducible** and **adaptable** by code  \n- Is **aesthetically** pleasing and follows conventions  \n\n\n## The 10 rules of good graphs\n![](../img/02_visualization/4.10simpleRules.png)\n\n## The 10 rules of good graphs\n:::::::::::::::::: {.r-fit-text}\n\n:::::: {.columns }\n::: {.column style=\"width='50%'; line-height=3em\"}\n*Rule 1:* **Know** your audience. (collaborators, journal readers ...).  \n*Rule 2:* **Identify** the role of the figure (&rArr; geometry).  \n*Rule 3:* **Adapt** to the medium (paper, poster, projection screen ...).  \n*Rule 4:* **Captions** are not optional.  \n*Rule 5:* **never** trust the **defaults** (size, font, colors ...): good enough for any, best for none.  \n:::\n:::{.column  width=\"50%\"}\n*Rule 6:* Use **color** effectively & only when needed.  \n*Rule 7:* Do Not **Mislead** the Reader (see examples below).  \n- As a rule of thumb, use the simplest type of plots   \n*Rule 8:* Avoid \"[Chartjunk](https://www.junkcharts.com/about/)\" (see examples below).  \n<!-- any decorations that do not tell the viewer something new must be banned --> \n<!-- Stephen Few : graphs should ideally ‘‘represent all the data that is needed to see and understand what’s meaningful.’’ --> \n*Rule 9:* **Message** trumps beauty.  \n*Rule 10:* Get the right **tool** (here `R` + `tidyverse` + `ggplot`)\n\n:::\n::::::\n\n\nAdditionally:   \n- seek external opinion.  \n- ensure reproducibility with your code.   \n- know the domain's best practices.  \n\n:::::::::::::::::: \n\n## Common [pitfalls](https://www.data-to-viz.com/caveats.html).\n- A good source of reflexions on graphical representation is:   \n![](../img/02_visualization/5.data-to-viz-caveats.png)\n\n## Common pitfalls 1/5\n:::::: {.columns }\n::: {.column style=\"width='50%'\"}\n![](../img/02_visualization/6.a.heatmap_pb.png)\n:::  \n::: {.column style=\"width='50%'\"}\n![](../img/02_visualization/6.b.heatmap_ok.png)\n:::\n::::::\n- **Inaccessible colors** (here for color blind people)\n\n\n## Common pitfalls 2/5\n![](../img/02_visualization/chartJunk.png)  \n\n- **Chart junk**.  \n\n## Common pitfalls 3/5\n![](../img/02_visualization/misleadingaxes.png){  height=500 }   \n\n- **Misleading axes**.  \n\n## Common pitfalls 4/5\n![](../img/02_visualization/pie_charts.png){ width=\"840\" height=200 margin=0} \n\n## Common pitfalls 5/5\n![](../img/02_visualization/pie_charts.png){ width=\"840\" height=200 margin=0} \n![](../img/02_visualization/pie_charts_correct.png){ width=\"840\" height=200  margin=0}\n\n- **Wrong geometry** (for what you show)\n\n<!--\n================================================================================================\n================================================================================================\n================================================================================================\n-->\n\n# Visualization\n<font color=\"gray\">1. graphics: Good & bad practices</font>  \n<font style=\"color:blue; font-weight:bold;\">2. individual graphics with ggplot</font>  \n<font color=\"gray\">3. Focus on heatmaps</font>  \n<font color=\"gray\">4. Plot composition</font>  \n<font color=\"gray\">5. some level of automation</font>  \n\n\n## Grammar of Graphics { .small}\n:::::::::::::::::: {.r-fit-text }\nLayered grammar of graphics in ggplot2 (as described in [wikipedia](https://en.wikipedia.org/wiki/Wilkinson%27s_Grammar_of_Graphics#Wickham%27s_Layered_Grammar_of_Graphics))\n\n:::::: {.columns }\n::: {.column style=\"width='50%'; line-height=2em\"}\n\n* **Defaults**: consists of data and mapping.  \n  + **Data**: dataset\n  + **Mapping**: aesthetic mappings\n:::\n::: {.column style=\"width='50%'; line-height=2em\"}\n* **Layer**: consists of data, mapping, geom, stat, and position\n  + **Data**: dataset, or inherit from defaults\n  + **Mapping**: aesthetic mappings, or inherit from defaults\n  + **Geom**: geometric object\n  + **Stat**: statistical transformation\n  + **Position**: position adjustment\n:::\n::: {.column style=\"width='50%'; line-height=2em\"}\n\n* **Scale**: mapping of data to aesthetic attributes\n* **Coord**: mapping of data to the plane of the plot\n* **Facet**: split up the data\n:::\n:::::: \n&rArr; See also the DebuteR training \n::::::::::::::::::\n\n## The exercise we gave you\n\nAll elements of this grammar of graphics is illustrated by the exercise we gave you by e-mail\n\n:::::: {.columns }\n::: {.column style=\"width='50%'; line-height=2em\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  weight genotype\n   <dbl> <chr>   \n1   0.23 WT      \n2   0.31 WT      \n3   0.28 WT      \n4   0.23 WT      \n5   0.19 WT      \n6   0.21 WT      \n```\n\n\n:::\n:::\n\n:::\n::: {.column style=\"width='50%'; line-height=2em\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/example_1_processing-1.png){fig-align='center' width=3000}\n:::\n:::\n\n:::\n::::::\n\n## exercise:\nCorrect this code to get this graphic \n\n::: {.small}\n(hint, we use `viridis`)   \n:::\n\n:::::: {.columns }\n::: {.column style=\"width='75%'; line-height=2em\"}\n:::::::::::::::::: {.r-fit-text }\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ng <- mtcars %>%\n  mutate(cyl = as.factor(cyl)) %>%\n  ggplot(\n    aes(x = cyl, \n        y = mpg, \n        fill = cyl)) +\n  geom_boxplot() +\n  labs(\n    title = \"Boxplot of MPG by Cylinder\",\n    x = \"Cyl\",\n    y = \"MPG\") +\n  theme_bw() + \n  theme(plot.background = element_rect(fill = \"lightgray\"))\n\ng\n```\n:::\n\n:::::::::::::::::: \n:::\n::: {.column style=\"width='25%'; line-height=2em\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/exercise_wrong_graph_corrected-1.png){fig-align='center' width=3000}\n:::\n:::\n\n:::\n::::::\n\n\n## Other often use improvement: \n### Statistical annotation and expression {.small}\n- Real world example \n![](../img/02_visualization/together_group_test.png)\n\n\n## Statistical Annotations with `ggpubr`\n- **compute comparisons and display the p-values**\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n## Statistical Annotations with `ggpubr`\n\n- **compute comparisons and display the p-values**\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n## Exercice\n\n- take the code above\n- change the statistical procedure used by `stat_compare_means`\n- display the formatted p value of every significant comparison\n\n## Statistical Annotations with `ggpubr`\n\n- **Display p-value from another test procedure**\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/signif-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n## Exercice\n- use the `data(\"ToothGrowth\")`\n- make the violin plot of teeth length according to the dose of vitamin C \n- Add the pairwise-pvalues\n\n\n## Add (mathematical) expressions\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n## exercice\n- start with this plot\n- use the Mathematical Annotations listed [here](https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/plotmath.html)\n- Correct the axis label and add the regression formula\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nChickWeight %>%\n  filter(Diet==4) %>%\n  ggplot( aes(x = Time, y = weight^(1/3))) +\n    geom_point() +\n    geom_smooth(method = \"lm\", se = TRUE) +\n    labs(\n          title = \"Cube root of weight according to time\",\n          x = \"Time\",\n          y=\"Cube root of weight\"\n    ) +\n    theme_classic() \n```\n\n::: {.cell-output-display}\n![](02_visualization_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n<!--\n================================================================================================\n================================================================================================\n================================================================================================\n-->\n",
    "supporting": [
      "02_visualization_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}