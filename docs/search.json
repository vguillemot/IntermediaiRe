[
  {
    "objectID": "pages/02_visualization.html#what-and-why",
    "href": "pages/02_visualization.html#what-and-why",
    "title": "Visualization",
    "section": "What and why ?",
    "text": "What and why ?\nA scientific visualization is a graphical interface between people and data.\n- There are many possible graphics for the same data.\n- Different people perceive theses graphics differently.\n An advanced graph :\n- Conveys complex information clearly\n- Integrates multiple layers of information\n- Is reproducible and adaptable by code\n- Is aesthetically pleasing and follows conventions",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#the-10-rules-of-good-graphs",
    "href": "pages/02_visualization.html#the-10-rules-of-good-graphs",
    "title": "Visualization",
    "section": "The 10 rules of good graphs",
    "text": "The 10 rules of good graphs",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#the-10-rules-of-good-graphs-1",
    "href": "pages/02_visualization.html#the-10-rules-of-good-graphs-1",
    "title": "Visualization",
    "section": "The 10 rules of good graphs",
    "text": "The 10 rules of good graphs\n\n\n\nRule 1: Know your audience. (collaborators, journal readers …).\nRule 2: Identify the role of the figure (⇒ geometry).\nRule 3: Adapt to the medium (paper, poster, projection screen …).\nRule 4: Captions are not optional.\nRule 5: never trust the defaults (size, font, colors …): good enough for any, best for none.\n\nRule 6: Use color effectively & only when needed.\nRule 7: Do Not Mislead the Reader (see examples below).\n- As a rule of thumb, use the simplest type of plots\nRule 8: Avoid “Chartjunk” (see examples below).\n  Rule 9: Message trumps beauty.\nRule 10: Get the right tool (here R + tidyverse + ggplot)\n\nAdditionally:\n- seek external opinion.\n- ensure reproducibility with your code.\n- know the domain’s best practices.",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#common-pitfalls.",
    "href": "pages/02_visualization.html#common-pitfalls.",
    "title": "Visualization",
    "section": "Common pitfalls.",
    "text": "Common pitfalls.\n\nA good source of reflexions on graphical representation is:",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#common-pitfalls-15",
    "href": "pages/02_visualization.html#common-pitfalls-15",
    "title": "Visualization",
    "section": "Common pitfalls 1/5",
    "text": "Common pitfalls 1/5\n\n\n\n\n\n\n\nInaccessible colors (here for color blind people)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#common-pitfalls-25",
    "href": "pages/02_visualization.html#common-pitfalls-25",
    "title": "Visualization",
    "section": "Common pitfalls 2/5",
    "text": "Common pitfalls 2/5\n\n\nChart junk.",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#common-pitfalls-35",
    "href": "pages/02_visualization.html#common-pitfalls-35",
    "title": "Visualization",
    "section": "Common pitfalls 3/5",
    "text": "Common pitfalls 3/5\n\n\nMisleading axes.",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#common-pitfalls-45",
    "href": "pages/02_visualization.html#common-pitfalls-45",
    "title": "Visualization",
    "section": "Common pitfalls 4/5",
    "text": "Common pitfalls 4/5",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#common-pitfalls-55",
    "href": "pages/02_visualization.html#common-pitfalls-55",
    "title": "Visualization",
    "section": "Common pitfalls 5/5",
    "text": "Common pitfalls 5/5\n \n\nWrong geometry (for what you show)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#grammar-of-graphics",
    "href": "pages/02_visualization.html#grammar-of-graphics",
    "title": "Visualization",
    "section": "Grammar of Graphics",
    "text": "Grammar of Graphics\n\nLayered grammar of graphics in ggplot2 (as described in wikipedia)\n\n\n\nDefaults: consists of data and mapping.\n\nData: dataset\nMapping: aesthetic mappings\n\n\n\n\nLayer: consists of data, mapping, geom, stat, and position\n\nData: dataset, or inherit from defaults\nMapping: aesthetic mappings, or inherit from defaults\nGeom: geometric object\nStat: statistical transformation\nPosition: position adjustment\n\n\n\n\nScale: mapping of data to aesthetic attributes\nCoord: mapping of data to the plane of the plot\nFacet: split up the data\n\n\n⇒ See also the DebuteR training",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#the-exercise-we-gave-you",
    "href": "pages/02_visualization.html#the-exercise-we-gave-you",
    "title": "Visualization",
    "section": "The exercise we gave you",
    "text": "The exercise we gave you\nAll elements of this grammar of graphics is illustrated by the exercise we gave you by e-mail\n\n\n\n\n# A tibble: 6 × 2\n  weight genotype\n   &lt;dbl&gt; &lt;chr&gt;   \n1   0.23 WT      \n2   0.31 WT      \n3   0.28 WT      \n4   0.23 WT      \n5   0.19 WT      \n6   0.21 WT",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercise",
    "href": "pages/02_visualization.html#exercise",
    "title": "Visualization",
    "section": "exercise:",
    "text": "exercise:\nCorrect this code to get this graphic\n\n(hint, we use viridis)\n\n\n\n\n\ng &lt;- mtcars %&gt;%\n  mutate(cyl = as.factor(cyl)) %&gt;%\n  ggplot(\n    aes(x = cyl, \n        y = mpg, \n        fill = cyl)) +\n  geom_boxplot() +\n  labs(\n    title = \"Boxplot of MPG by Cylinder\",\n    x = \"Cyl\",\n    y = \"MPG\") +\n  theme_bw() + \n  theme(plot.background = element_rect(fill = \"lightgray\"))\n\ng",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#other-often-use-improvement",
    "href": "pages/02_visualization.html#other-often-use-improvement",
    "title": "Visualization",
    "section": "Other often use improvement:",
    "text": "Other often use improvement:\nStatistical annotation and expression\n\nReal world example",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#statistical-annotations-with-ggpubr",
    "href": "pages/02_visualization.html#statistical-annotations-with-ggpubr",
    "title": "Visualization",
    "section": "Statistical Annotations with ggpubr",
    "text": "Statistical Annotations with ggpubr\n\ncompute comparisons and display the p-values\n\n\n\n# install.packages(\"ggpubr\")\nlibrary(ggpubr)\n\nggplot(\n   mtcars, \n   aes(\n     x=as.factor(cyl), \n     y=mpg, \n     fill = as.factor(cyl)\n   )\n ) + \n   geom_boxplot() +\n   stat_compare_means() +\n   theme_classic2()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#statistical-annotations-with-ggpubr-1",
    "href": "pages/02_visualization.html#statistical-annotations-with-ggpubr-1",
    "title": "Visualization",
    "section": "Statistical Annotations with ggpubr",
    "text": "Statistical Annotations with ggpubr\n\ncompute comparisons and display the p-values\n\n\n\nmsleep %&gt;%\n  group_by(order) %&gt;% \n  filter(n()&gt;=6) %&gt;%\nggplot( aes(order, sleep_total, fill = order)) + \n  geom_boxplot() +\n  stat_compare_means(label.y = 22) +\n  stat_compare_means(comparisons = list( \n     c(\"Artiodactyla\", \"Carnivora\"), \n     c(\"Artiodactyla\", \"Primates\"),\n    c(\"Artiodactyla\", \"Rodentia\")\n    ), label = \"p.signif\")  + \n  theme_classic2()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercice",
    "href": "pages/02_visualization.html#exercice",
    "title": "Visualization",
    "section": "Exercice",
    "text": "Exercice\n\ntake the code above\nchange the statistical procedure used by stat_compare_means\ndisplay the formatted p value of every significant comparison",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#statistical-annotations-with-ggpubr-2",
    "href": "pages/02_visualization.html#statistical-annotations-with-ggpubr-2",
    "title": "Visualization",
    "section": "Statistical Annotations with ggpubr",
    "text": "Statistical Annotations with ggpubr\n\nDisplay p-value from another test procedure\n\n\n\nmyTests &lt;- data.frame(\n              group1 = c(\"Artiodactyla\", \"Primates\" , \"Artiodactyla\", \"Rodentia\", \"Rodentia\",  \"Rodentia\") ,\n              group2 = c(\"Carnivora\"   , \"Carnivora\", \"Primates\"    , \"Primates\", \"Carnivora\", \"Artiodactyla\"), \n              p      = c(0.0076        , 0.79       , 0.0012        , 0.047     ,  0.045     ,  0.00057),\n              other  = c(\"S\"           , \"NS\"       , \"S\"           , \"S\"       , \"S\"        , \"S\") \n  \n)\nmsleep %&gt;%\n  group_by(order) %&gt;% \n  filter(n()&gt;=6) %&gt;%\nggplot( aes(order, sleep_total, fill = order)) + \n  geom_boxplot() +\n  stat_pvalue_manual( myTests, y.position = 17, step.increase = 0.05, label = \"other\", tip.length = 0.01) +\n  theme_classic2()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercice-1",
    "href": "pages/02_visualization.html#exercice-1",
    "title": "Visualization",
    "section": "Exercice",
    "text": "Exercice\n\nuse the data(\"ToothGrowth\")\nmake the violin plot of teeth length according to the dose of vitamin C\nAdd the pairwise-pvalues",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#add-mathematical-expressions",
    "href": "pages/02_visualization.html#add-mathematical-expressions",
    "title": "Visualization",
    "section": "Add (mathematical) expressions",
    "text": "Add (mathematical) expressions\n\n\nggplot(mtcars, aes(x = wt, y = mpg)) +\n    geom_point() +\n    geom_smooth(method = \"lm\", se = TRUE) +\n    stat_cor(label.x = 3, label.y = 34) +\n\n      stat_regline_equation(label.x = 3, label.y = 32) +\n        labs(\n          title = expression(mpg == beta[0] + beta[1]*wt + epsilon[i]),\n          x = expression(log[10](Wt)),\n          y=\"Fuel consumption\"\n               )+\n\n        theme_classic()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercice-2",
    "href": "pages/02_visualization.html#exercice-2",
    "title": "Visualization",
    "section": "exercice",
    "text": "exercice\n\nstart with this plot\nuse the Mathematical Annotations listed in ?plotmath\nCorrect the axis label and add the regression formula\n\n\n\nChickWeight %&gt;%\n  filter(Diet==4) %&gt;%\n  ggplot( aes(x = Time, y = weight^(1/3))) +\n    geom_point() +\n    geom_smooth(method = \"lm\", se = TRUE) +\n    labs(\n          title = \"Cube root of weight according to time\",\n          x = \"Time\",\n          y=\"Cube root of weight\"\n    ) +\n    theme_classic()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#complex-heatmap",
    "href": "pages/02_visualization.html#complex-heatmap",
    "title": "Visualization",
    "section": "Complex heatmap",
    "text": "Complex heatmap\n\nspecific plots like heatmap often have dedicated packages\nhere we choose the heatmap since\n\nit is widely used\nwe will use it tomorrow in the main exercise.",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#complex-heatmap-package",
    "href": "pages/02_visualization.html#complex-heatmap-package",
    "title": "Visualization",
    "section": "Complex heatmap package",
    "text": "Complex heatmap package\n\nA bioconductor package\n\n\n#BiocManager::install(\"ComplexHeatmap\")\nlibrary(ComplexHeatmap)\n\n\nwith an extensive documentation\n\navailable here\nor by\n\n\n\n#BiocManager::install(\"ComplexHeatmap\")\nvignette(\"complex_heatmap\")",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#heatmap-structure",
    "href": "pages/02_visualization.html#heatmap-structure",
    "title": "Visualization",
    "section": "Heatmap structure",
    "text": "Heatmap structure",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#data-for-the-heatmap",
    "href": "pages/02_visualization.html#data-for-the-heatmap",
    "title": "Visualization",
    "section": "data for the heatmap:",
    "text": "data for the heatmap:\n\nLet’s make a mock dataset\n\n\nset.seed(123)\nmat = matrix(rnorm(120), 10)\n\nrownames(mat) = paste0(\"R\", 1:10)\ncolnames(mat) = paste0(\"C\", 1:12)\n\nrow_info &lt;- data.frame(cond=rnorm(10) &lt; 0, score=runif(10))\ncolumn_info &lt;- data.frame(order=1:12, category=rep(0:2,4) )",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#make-a-basic-heatmap",
    "href": "pages/02_visualization.html#make-a-basic-heatmap",
    "title": "Visualization",
    "section": "make a basic heatmap",
    "text": "make a basic heatmap\n\nHeatmap(mat, \n        name=\"my heatmap\", \n        column_title = \"column maybe genes\", \n        row_title = \"row maybe samples\")\n\n\nBasic layout includes\n\nthe heatmap.\n\nthe row and column labels.\n\na default clustering.",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#complete-the-heatmap-add-annotations",
    "href": "pages/02_visualization.html#complete-the-heatmap-add-annotations",
    "title": "Visualization",
    "section": "complete the heatmap: add annotations",
    "text": "complete the heatmap: add annotations\n\nusing a dataframe directly give and overview\n\n\n\nHeatmap(mat, \n        name=\"my heatmap\",\n        column_title = \"column maybe genes\", \n        row_title = \"row maybe samples\" , \n        top_annotation = HeatmapAnnotation(df=column_info),\n        left_annotation = HeatmapAnnotation(df=row_info, which = \"row\")\n)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#complete-the-heatmap-add-annotations-1",
    "href": "pages/02_visualization.html#complete-the-heatmap-add-annotations-1",
    "title": "Visualization",
    "section": "complete the heatmap: add annotations",
    "text": "complete the heatmap: add annotations\nWe have more control by selecting each annotations to be displayed separately\n\n\ncolumn_annot &lt;- HeatmapAnnotation(\n                 order=anno_barplot(column_info$order), \n                 category=column_info$category)\nrow_annot &lt;- HeatmapAnnotation(\n                  score=anno_barplot(row_info$score),\n                  cond=row_info$cond, which = \"row\")\n\nHeatmap(mat, \n        name=\"my heatmap\",\n        column_title = \"column maybe genes\", \n        row_title = \"row maybe samples\" , \n        top_annotation = column_annot,\n        left_annotation = row_annot\n)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-colors-main",
    "href": "pages/02_visualization.html#customise-colors-main",
    "title": "Visualization",
    "section": "customise colors : main",
    "text": "customise colors : main\n\n\nmain_col_fun = circlize::colorRamp2(\n                   c(-2, 0, 2),\n                   c(\"darkblue\", \"white\", \"orangered\"))\nHeatmap(mat, \n        name=\"my heatmap\",\n        column_title = \"column maybe genes\", \n        row_title = \"row maybe samples\" , \n        top_annotation = column_annot,\n        left_annotation = row_annot,\n        col = main_col_fun\n)\n\n\n\n\n\n\n\n\n\n\nyou set the limits of the colors yourself\n⇒ enables you to compare heatmaps",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-colors-annotations",
    "href": "pages/02_visualization.html#customise-colors-annotations",
    "title": "Visualization",
    "section": "customise colors : annotations",
    "text": "customise colors : annotations\n\n\ncolumn_annot &lt;- HeatmapAnnotation(\n                 order=anno_barplot(column_info$order), \n                 category=column_info$category,\n                 col=list(category=c(\"0\"=\"#AAE89CFF\", \"1\"=\"#79DB6BFF\", \"2\"=\"#32CD32FF\"))\n                  \n                 )\nrow_annot &lt;- HeatmapAnnotation(\n                  score=anno_barplot(row_info$score),\n                  cond=row_info$cond, which = \"row\",\n                  col=list(cond=c(\"TRUE\"=\"black\", \"FALSE\"=\"white\"))\n                  )\n\nHeatmap(mat, \n        name=\"my heatmap\",\n        column_title = \"column maybe genes\", \n        row_title = \"row maybe samples\" , \n        top_annotation = column_annot,\n        left_annotation = row_annot,\n        col = main_col_fun\n)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-colors-titles",
    "href": "pages/02_visualization.html#customise-colors-titles",
    "title": "Visualization",
    "section": "customise colors : titles",
    "text": "customise colors : titles\n\n\nHeatmap(mat, \n        name=\"my heatmap\",\n        column_title = \"column maybe genes\", \n        column_title_gp = gpar(fill = \"grey\", col = \"white\", border = \"blue\"),\n        row_title = \"row maybe samples\" , \n        top_annotation = column_annot,\n        left_annotation = row_annot,\n        col = main_col_fun\n)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-positions",
    "href": "pages/02_visualization.html#customise-positions",
    "title": "Visualization",
    "section": "customise positions",
    "text": "customise positions\n\n\nHeatmap(mat, \n        name=\"my heatmap\",\n        column_title = \"column maybe genes\", \n        column_title_side =\"bottom\",\n        row_title = \"row maybe samples\" , \n        row_title_side =\"right\",\n        bottom_annotation = column_annot,\n        right_annotation = row_annot,\n        col = main_col_fun\n)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercise-1",
    "href": "pages/02_visualization.html#exercise-1",
    "title": "Visualization",
    "section": "exercise",
    "text": "exercise\n\ntake the heatmap we are building\nsplit the row annotation on each side\nsplit the columns annotation on each side",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-clustering",
    "href": "pages/02_visualization.html#customise-clustering",
    "title": "Visualization",
    "section": "customise clustering",
    "text": "customise clustering\n\neither use or remove the clusetering\n\n\nHeatmap(mat, name = \"mat\", cluster_rows = FALSE, cluster_columns = FALSE)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-clustering-1",
    "href": "pages/02_visualization.html#customise-clustering-1",
    "title": "Visualization",
    "section": "customise clustering",
    "text": "customise clustering\n\neither use or remove the clusetering\n\n\nbasic_ht &lt;- Heatmap(mat, name = \"mat\") \nrow_order(basic_ht)\n\n [1]  6  3  4  5  1  9  2 10  7  8\n\ncolumn_order(basic_ht)\n\n [1] 10  2  4  1  8  6  5 12  9  7 11  3\n\nHeatmap(mat, name = \"mat\", cluster_rows = FALSE, cluster_columns = FALSE)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-clustering-2",
    "href": "pages/02_visualization.html#customise-clustering-2",
    "title": "Visualization",
    "section": "customise clustering",
    "text": "customise clustering\n\nWe can change the display of the dendrogram\n\n\n\nHeatmap(mat, \n    name = \"mat\",\n    row_dend_width = unit(4, \"cm\"),\n    row_dend_side = \"right\",\n    column_dend_height = unit(4, \"cm\"),\n    column_dend_side = \"bottom\"\n  )",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-clustering-3",
    "href": "pages/02_visualization.html#customise-clustering-3",
    "title": "Visualization",
    "section": "customise clustering",
    "text": "customise clustering\n\nWe can change the parameters as in hclut\n\n\nHeatmap(mat, \n       name = \"mat\", \n       clustering_distance_rows = \"pearson\",\n       column_title = \"pre-defined distance method (1 - pearson)\"\n       )",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#customise-clustering-4",
    "href": "pages/02_visualization.html#customise-clustering-4",
    "title": "Visualization",
    "section": "customise clustering",
    "text": "customise clustering\n\nWe can give a already made dendrogram\n\n\nrow_dend = as.dendrogram(hclust(dist(mat)))\nrow_dend = dendextend::color_branches   (row_dend, k = 2) \nHeatmap(mat, \n        name = \"mat\", \n        cluster_rows = row_dend\n        )",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#split-heatmap",
    "href": "pages/02_visualization.html#split-heatmap",
    "title": "Visualization",
    "section": "split heatmap",
    "text": "split heatmap\n\nby clustering using row_km/column_km or column_split /row_split\n\n\nHeatmap(mat, name = \"mat\", cluster_rows = row_dend, row_split = 2, column_split = 3)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#split-heatmap-1",
    "href": "pages/02_visualization.html#split-heatmap-1",
    "title": "Visualization",
    "section": "split heatmap",
    "text": "split heatmap\n\nby categorical variables\n\n\nHeatmap(mat, \n        name = \"mat\", \n        row_split = row_info$cond\n      )",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercise-2",
    "href": "pages/02_visualization.html#exercise-2",
    "title": "Visualization",
    "section": "Exercise",
    "text": "Exercise\n\ntake a previous heatmap with the annotations\nchange the clustering parameters\nsplit the heatmap according to the clustering\nrecover the row labels in the order of the clustering",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#kind-of-plot-composition",
    "href": "pages/02_visualization.html#kind-of-plot-composition",
    "title": "Visualization",
    "section": "3 kind of plot composition",
    "text": "3 kind of plot composition\n\nSplit a plot by conditions: facet\nMake one plot from several: aplot\nPut together several plots: ggarrange and patchwork",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#split-a-plot-by-conditions-facet",
    "href": "pages/02_visualization.html#split-a-plot-by-conditions-facet",
    "title": "Visualization",
    "section": "Split a plot by conditions: facet",
    "text": "Split a plot by conditions: facet\n\nSee the course for R beginners\n\n\nChickWeight %&gt;%\n  filter(Diet==4) %&gt;%\n  ggplot( aes(x = Time, y = weight^(1/3))) +\n    geom_point() +\n    geom_smooth(method = \"lm\", se = TRUE) +\n    labs(\n          title = \"Cube root of weight according to time\",\n          x = \"Time\",\n          y=\"Cube root of weight\"\n    ) +\n    theme_classic()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#split-a-plot-by-conditions-facet-1",
    "href": "pages/02_visualization.html#split-a-plot-by-conditions-facet-1",
    "title": "Visualization",
    "section": "Split a plot by conditions: facet",
    "text": "Split a plot by conditions: facet\n\nSee the course for R beginners\n\n\np &lt;- ChickWeight %&gt;% \n  ggplot( aes(x = Time, y = weight^(1/3))) +\n    geom_point() +\n    geom_smooth(method = \"lm\", se = TRUE) +\n    labs(\n          title = \"Cube root of weight according to time\",\n          x = \"Time\",\n          y=\"Cube root of weight\"\n    ) +\n    theme_classic()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#split-a-plot-by-conditions-facet-2",
    "href": "pages/02_visualization.html#split-a-plot-by-conditions-facet-2",
    "title": "Visualization",
    "section": "Split a plot by conditions: facet",
    "text": "Split a plot by conditions: facet\n\np + facet_wrap( ~ Diet)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#split-a-plot-by-conditions-facet-3",
    "href": "pages/02_visualization.html#split-a-plot-by-conditions-facet-3",
    "title": "Visualization",
    "section": "Split a plot by conditions: facet",
    "text": "Split a plot by conditions: facet\n\np + facet_grid( Diet ~ .)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#make-one-plot-from-several-aplot",
    "href": "pages/02_visualization.html#make-one-plot-from-several-aplot",
    "title": "Visualization",
    "section": "Make one plot from several: aplot",
    "text": "Make one plot from several: aplot\n\nReal life example",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#make-one-plot-from-several-aplot-1",
    "href": "pages/02_visualization.html#make-one-plot-from-several-aplot-1",
    "title": "Visualization",
    "section": "Make one plot from several: aplot",
    "text": "Make one plot from several: aplot\n\nWorking code example\n\n\nlibrary(aplot)\n\np &lt;- ggplot(mtcars, aes(mpg, disp)) + geom_point()\np2 &lt;- ggplot(mtcars, aes(mpg)) + \n    geom_density(fill='steelblue', alpha=.5) + \n        ggfun::theme_noxaxis()\np3 &lt;- ggplot(mtcars, aes(x=1, y=disp)) + \n    geom_boxplot(fill='firebrick', alpha=.5) + \n    theme_void()\np %&gt;% \n    insert_top(p2, height=.3) %&gt;% \n    insert_right(p3, width=.1)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#put-together-several-plots-with-patchwork",
    "href": "pages/02_visualization.html#put-together-several-plots-with-patchwork",
    "title": "Visualization",
    "section": "Put together several plots with patchwork",
    "text": "Put together several plots with patchwork\nggarrange and patchwork are ways to assemble several plots in a single figure. For ggarrange se the beginner R course\npatchwork defines. or augments 6 opreator on plots: + - / | * & the most user friendly ones are + | and /\n\n# install.packages(\"patchwork\")\nlibrary(patchwork)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-example-data",
    "href": "pages/02_visualization.html#patchwork-example-data",
    "title": "Visualization",
    "section": "patchwork example data",
    "text": "patchwork example data\nWe will combine thoses 3 plots:\n\np1 &lt;- ggplot(mtcars, aes(mpg, wt)) + geom_point()\np2 &lt;- ggplot(mtcars, aes(x = cyl)) + geom_bar()\np3 &lt;-  ggplot(mtcars) + geom_boxplot(aes(gear, disp, group = gear))",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-basic-usage",
    "href": "pages/02_visualization.html#patchwork-basic-usage",
    "title": "Visualization",
    "section": "patchwork Basic usage",
    "text": "patchwork Basic usage\n+ group the plots\n\np1 + p2  + p3",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-basic-usage-1",
    "href": "pages/02_visualization.html#patchwork-basic-usage-1",
    "title": "Visualization",
    "section": "patchwork Basic usage",
    "text": "patchwork Basic usage\n| put the plots side by side\n\np1 + p2  | p3",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-basic-usage-2",
    "href": "pages/02_visualization.html#patchwork-basic-usage-2",
    "title": "Visualization",
    "section": "patchwork Basic usage",
    "text": "patchwork Basic usage\n/ stack the plots together\n\np1 / p2  # Disposition en ligne",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-set-the-layouts",
    "href": "pages/02_visualization.html#patchwork-set-the-layouts",
    "title": "Visualization",
    "section": "patchwork set the layouts",
    "text": "patchwork set the layouts\nplot_layout give a finer control over the resulting plot\n\np1 + p2 + p3 + plot_layout(ncol = 1)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-set-the-layouts-1",
    "href": "pages/02_visualization.html#patchwork-set-the-layouts-1",
    "title": "Visualization",
    "section": "patchwork set the layouts",
    "text": "patchwork set the layouts\nplot_layout give a finer control over the resulting plot\n\np1 | p2 + p3 + plot_layout(ncol = 1)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-set-the-layouts-2",
    "href": "pages/02_visualization.html#patchwork-set-the-layouts-2",
    "title": "Visualization",
    "section": "patchwork set the layouts",
    "text": "patchwork set the layouts\n\np1 | p2 + p3 + plot_layout(ncol = 1, heights = c(2, 1))",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-nesting-levels",
    "href": "pages/02_visualization.html#patchwork-nesting-levels",
    "title": "Visualization",
    "section": "patchwork nesting levels",
    "text": "patchwork nesting levels\n\n(p1 + ( p2 + p3)) + plot_layout(ncol = 1, heights = c(2, 1))",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-add-other-customisation",
    "href": "pages/02_visualization.html#patchwork-add-other-customisation",
    "title": "Visualization",
    "section": "patchwork Add other customisation",
    "text": "patchwork Add other customisation\n\np1 | p2 + p3 + plot_layout(ncol = 1, heights = c(2, 1)) + theme_bw()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-add-other-customisation-1",
    "href": "pages/02_visualization.html#patchwork-add-other-customisation-1",
    "title": "Visualization",
    "section": "patchwork Add other customisation",
    "text": "patchwork Add other customisation\n\np1 | p2 + p3 + plot_layout(ncol = 1, heights = c(2, 1))  & theme_bw()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#patchwork-add-other-customisation-2",
    "href": "pages/02_visualization.html#patchwork-add-other-customisation-2",
    "title": "Visualization",
    "section": "patchwork Add other customisation",
    "text": "patchwork Add other customisation\n\n(p1 | p2 + p3 + plot_layout(ncol = 1, heights = c(2, 1)) ) & theme_bw()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#exercice-make-a-multipanel-figure",
    "href": "pages/02_visualization.html#exercice-make-a-multipanel-figure",
    "title": "Visualization",
    "section": "Exercice: make a Multipanel Figure",
    "text": "Exercice: make a Multipanel Figure\n\nTake any 3 graphics generated today\nUse patchwork to combine them in a single figure.",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#functions",
    "href": "pages/02_visualization.html#functions",
    "title": "Visualization",
    "section": "functions",
    "text": "functions\n\nA function in R is 2 things\n\n\n\na block of code stored and executed when called.\n\n\n\nan object composed of\n\n\n\n\ncomponent\naccessed using\n\n\n\n\narguments\nformals()\n\n\nbody\nbody()\n\n\nenvironment\nenvironment()\n\n\n\n\n\n\nA function can be created in two ways\n\nuse a function that creates specific functions like colorRamp2()\n\nuse the function function()",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#functions-example",
    "href": "pages/02_visualization.html#functions-example",
    "title": "Visualization",
    "section": "functions: example",
    "text": "functions: example\n\n# Pval_Pyramids\n# Indicates the number of pvalues in each categories according to the hard coded threshold\n# args: pvals: a vector of numeric values assumed to be pvalues\n# return: a dataframe with columns interval and nb\nPval_Pyramids &lt;- function(pvals){\n  breaksForCut &lt;- c(-1, 0, 1e-300, 1e-200, 1e-100, 1e-50, 1e-10, 1e-5, 1e-4, 1e-3, 1e-2, 5e-2, 1)\n  labelsForCut &lt;- c(\"p=0\", \"0&lt;p&lt;=1e-300\", \"1e-300&lt;p&lt;=1e-200\", \"1e-200&lt;p&lt;=1e-100\", \"1e-100&lt;p&lt;=1e-50\", \"1e-50&lt;p&lt;=1e-10\", \"1e-10&lt;p&lt;=1e-05\", \"1e-05&lt;p&lt;=1e-4\", \"1e-4&lt;p&lt;=0.001\", \"0.001&lt;p&lt;=0.01\", \"0.01&lt;p&lt;=0.05\", \"0.05&lt;p&lt;=1\")\n  Ppyram &lt;- pvals %&gt;% \n              cut(breaks=breaksForCut, labels=labelsForCut)  %&gt;% \n              table() %&gt;% as.data.frame() %&gt;% \n              rename(interval=1, nb=Freq)\n  return(Ppyram)\n}",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#functions-exercise",
    "href": "pages/02_visualization.html#functions-exercise",
    "title": "Visualization",
    "section": "functions: exercise",
    "text": "functions: exercise\n\ntake any code for a plot and make a fucntion of it\napply this function on other data",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#for-loops",
    "href": "pages/02_visualization.html#for-loops",
    "title": "Visualization",
    "section": "for loops",
    "text": "for loops\n\nmost used kind of loops (in our experience)\nprinciple define an object that will take different values succesively\nrepeat the same process on this object for each value\n\n\n\niteration &lt;- c(\"toto\", \"titi\", \"tata\")\n\nfor(i in iteration){\n  print(i)\n}\n\n\n[1] \"toto\"\n[1] \"titi\"\n[1] \"tata\"\n\n\n ⚠ loops are used to iterate over parameters than are not in the data, not over the data (use apply instead)",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#for-loops-example",
    "href": "pages/02_visualization.html#for-loops-example",
    "title": "Visualization",
    "section": "for loops: example",
    "text": "for loops: example\n\ntest several split of cluters\n\n\nfor(k in 2:4) {\n  htmp &lt;- Heatmap(mat, name = \"mat\", row_km = k, row_title = \"cluster_%s\")  \n  print(htmp)\n}",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#for-loops-example-1",
    "href": "pages/02_visualization.html#for-loops-example-1",
    "title": "Visualization",
    "section": "for loops: example",
    "text": "for loops: example",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/02_visualization.html#for-loops-exercise",
    "href": "pages/02_visualization.html#for-loops-exercise",
    "title": "Visualization",
    "section": "for loops: exercise",
    "text": "for loops: exercise\n\ncorrect this loop\nkeep the different heatmaps in a list\nprint them outside this loop\n\n\nfor(k in 2:4) {\n  Heatmap(mat, name = \"mat\", row_km = i, row_title = \"cluster_%s\")  \n}",
    "crumbs": [
      "Visualization"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#recto",
    "href": "pages/01_rmarkdown.html#recto",
    "title": "Reproducible Reports with R Markdown",
    "section": "Recto",
    "text": "Recto",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#verso",
    "href": "pages/01_rmarkdown.html#verso",
    "title": "Reproducible Reports with R Markdown",
    "section": "Verso",
    "text": "Verso",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#r-markdown",
    "href": "pages/01_rmarkdown.html#r-markdown",
    "title": "Reproducible Reports with R Markdown",
    "section": "R Markdown",
    "text": "R Markdown",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#yaml",
    "href": "pages/01_rmarkdown.html#yaml",
    "title": "Reproducible Reports with R Markdown",
    "section": "YAML",
    "text": "YAML\n---\ntitle: \"Document title\"\nauthor: \"Lewis Forwarder\"\noutput: html_document\n---\n\nStarts with ---, ends with ---\nIntuitive syntax \\(\\rightarrow\\) field: value\nOutputs: HTML, docx, pptx, (pdf)",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#markdown",
    "href": "pages/01_rmarkdown.html#markdown",
    "title": "Reproducible Reports with R Markdown",
    "section": "Markdown",
    "text": "Markdown\nIntuitive language to write, in plain text, a document that is transformed into a report (in Rstudio, go to submenu “Help &gt; Markdown Quick Reference” for a quick tour).\n\nEmphasis\n*italic*   **bold**\n_italic_   __bold__\nHeaders\n# Header 1\n## Header 2\n### Header 3\n\nUnordered List\n* Item 1\n* Item 2\n    + Item 2a\n    + Item 2b\n\nOrdered List\n1. Item 1\n2. Item 2\n3. Item 3\n    + Item 3a\n    + Item 3b\n\nAnd so much more!",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#r-chunks",
    "href": "pages/01_rmarkdown.html#r-chunks",
    "title": "Reproducible Reports with R Markdown",
    "section": "R Chunks",
    "text": "R Chunks\nYour code goes in “R chunks”1.\n\n\n\n```{r chunk title, echo = TRUE}\nhist(rnorm(100))\n```\n\n\n\n\n\n\n\n\n\n\n\nCustomization:\n\nBeginners: ⚙️,\nIntermediate users: go here,\nAdvanced users: Yi Hui’s website.\n\n\nclick on “+c” to insert a chunk quickly",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#other-features",
    "href": "pages/01_rmarkdown.html#other-features",
    "title": "Reproducible Reports with R Markdown",
    "section": "Other features",
    "text": "Other features\n\nPDF: \\(\\LaTeX\\)\nMaths: \\(\\LaTeX\\)\nCustomized HTML documents: CSS (ou SCSS)\nDiagrams: mermaid or GraphViz\nOther high-level programming languages: Python, Julia, SQL\nOther: bash, Rcpp (C++), Stan (Bayesian statistics), etc.",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#yet-another-markdown-language",
    "href": "pages/01_rmarkdown.html#yet-another-markdown-language",
    "title": "Reproducible Reports with R Markdown",
    "section": "[Y]et [A]nother [M]arkdown [L]anguage",
    "text": "[Y]et [A]nother [M]arkdown [L]anguage\n---\ntitle: \"This should be a useful title\"\nauthor: \"Pr Jean Bon\"\noutput: pdf_document\n---\n\nStarts with ---, ends with ---\nIntuitive syntax \\(\\rightarrow\\) field: value\nOutputs: HTML, docx, pptx, (pdf)\nAlso: it is optional!",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#most-useful-fields",
    "href": "pages/01_rmarkdown.html#most-useful-fields",
    "title": "Reproducible Reports with R Markdown",
    "section": "Most useful fields",
    "text": "Most useful fields\n\ntitle: title of the document\nauthor: your name\noutput:\n\nhtml_document \\(\\rightarrow\\) is the easiest to use\nword_document \\(\\rightarrow\\) is very convenient\npdf_document \\(\\rightarrow\\) requires \\(\\LaTeX\\)",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#in-rstudio",
    "href": "pages/01_rmarkdown.html#in-rstudio",
    "title": "Reproducible Reports with R Markdown",
    "section": "In Rstudio",
    "text": "In Rstudio\n\n\nFile &gt; New File &gt; R Markdown…\n\ncreate a document,\nchange the default values,\nchange\n\nheaders,\ntext,\nR code,\n\nsave document as an Rmd file.\nClick on “Knit”",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#exercise-1-header-alone",
    "href": "pages/01_rmarkdown.html#exercise-1-header-alone",
    "title": "Reproducible Reports with R Markdown",
    "section": "Exercise 1: header alone",
    "text": "Exercise 1: header alone\nCreate an R Markdown document that will create the following html output.",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#examples",
    "href": "pages/01_rmarkdown.html#examples",
    "title": "Reproducible Reports with R Markdown",
    "section": "Examples",
    "text": "Examples\n\n\n\nTwinkle **twinkle** ~little~ _star_\n\n\n$$ y = \\frac{1}{2\\pi} e^{x^2} $$\n\n\n\n\n\n* One item\n* Two items\n\n\n\nTwinkle twinkle little star\n\n\n\\[\ny = \\frac{1}{2\\pi} e^{x^2}\n\\]\n\n\n\nOne item\nTwo items",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#in-rstudio-1",
    "href": "pages/01_rmarkdown.html#in-rstudio-1",
    "title": "Reproducible Reports with R Markdown",
    "section": "In Rstudio",
    "text": "In Rstudio\n\n\nUseful ressources:\n\nMarkdown Quick Reference Guide (\\(\\rightarrow\\))\nCheatsheet\nMarkdown Guide",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#exercise-2-only-text",
    "href": "pages/01_rmarkdown.html#exercise-2-only-text",
    "title": "Reproducible Reports with R Markdown",
    "section": "Exercise 2: only text",
    "text": "Exercise 2: only text\nCreate an R Markdown document that will create the following html output.\n\n\n\n\n\n\n\n\nWarning\n\n\nThere is no YAML header!",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#regular-chunk",
    "href": "pages/01_rmarkdown.html#regular-chunk",
    "title": "Reproducible Reports with R Markdown",
    "section": "Regular chunk",
    "text": "Regular chunk",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#setup-chunk",
    "href": "pages/01_rmarkdown.html#setup-chunk",
    "title": "Reproducible Reports with R Markdown",
    "section": "Setup chunk",
    "text": "Setup chunk",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#my-advice",
    "href": "pages/01_rmarkdown.html#my-advice",
    "title": "Reproducible Reports with R Markdown",
    "section": "My advice",
    "text": "My advice\n\ncreate your chunk by clicking on the “+c” button\ncustomize its options by clicking on the wheel\nwrite your R script (execute often)\nknit often\n\n\n\n\n\n\n\n\nWarning\n\n\nYour current environment is different from the temp environment that is created to generate the report!",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/01_rmarkdown.html#exercise-3-yaml-markdown-r",
    "href": "pages/01_rmarkdown.html#exercise-3-yaml-markdown-r",
    "title": "Reproducible Reports with R Markdown",
    "section": "Exercise 3: YAML + Markdown + R",
    "text": "Exercise 3: YAML + Markdown + R\n\n\nCreate an R Markdown document that will create this (\\(\\rightarrow\\)) output.",
    "crumbs": [
      "R Markdown"
    ]
  },
  {
    "objectID": "pages/03_project.html",
    "href": "pages/03_project.html",
    "title": "Workshop: reproduce a complex panelled figure",
    "section": "",
    "text": "In this workshop, you will reproduce Figure 2 from (Ong et al. 2020) (from the cleaned data located here) and write a short report explaining your choices, results, and limitations.",
    "crumbs": [
      "Project"
    ]
  },
  {
    "objectID": "pages/03_project.html#the-figure",
    "href": "pages/03_project.html#the-figure",
    "title": "Workshop: reproduce a complex panelled figure",
    "section": "The Figure",
    "text": "The Figure\nFigure 2 contains three sub-panels:\n\na clustered heatmap with sample annotations,\nlongitudinal expression profiles for inflammatory genes,\nlongitudinal expression profiles for T-cell markers.",
    "crumbs": [
      "Project"
    ]
  },
  {
    "objectID": "pages/03_project.html#detailed-instructions",
    "href": "pages/03_project.html#detailed-instructions",
    "title": "Workshop: reproduce a complex panelled figure",
    "section": "Detailed instructions",
    "text": "Detailed instructions\nWork in groups of 3–4.\nStart with each subfigure individually to break up your workload. For example:\n\ncreate a project,\nsave the dataset (located here) in the project’s folder and load it in the environment,\nreproduce first the subfigure showing the expression profile of IL1A with ggplot2,\ncreate a function from the previous code that takes as input the name of the gene and outputs the figure,\ncreate subpanels B and C with patchwork,\nwork on reproducing the heatmap with ComplexHeatmap,\ncombine everything in one big panel.\n\nWrite your comments describing your work in an R Mardown document, with an HTML output, breaking down the steps.\nAt the end of the day, present your work: what you achieved, where you had difficulties, the questions you had. We will show you our own version.",
    "crumbs": [
      "Project"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "IntermediaiRe",
    "section": "",
    "text": "This is the companion website for the class “IntermediaiRe”1. You will find here the objectives, schedule, slides, and other materials related to this course.",
    "crumbs": [
      "Course description"
    ]
  },
  {
    "objectID": "index.html#footnotes",
    "href": "index.html#footnotes",
    "title": "IntermediaiRe",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nhave you spotted this infinitely funny pun that works only in French?↩︎",
    "crumbs": [
      "Course description"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#schedule-language-etc",
    "href": "pages/00_reminders.html#schedule-language-etc",
    "title": "Introduction and Reminders",
    "section": "Schedule, language, etc",
    "text": "Schedule, language, etc\n\nDay 1: tips and tricks of dplyr and ggplot2. Create a report in R Markdown.\nDay 2: Heatmaps, and other advanced graphical representations. Create panels of plots. Good practices in data visualization.\nDay 3: work on your data.",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#this-is-us",
    "href": "pages/00_reminders.html#this-is-us",
    "title": "Introduction and Reminders",
    "section": "This is us",
    "text": "This is us\n\n\n\n\n\nAmaury Vaysse, bioinformatician\n\n\n\n\n\n\n\n\nVincent Guillemot, biostatistician",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#course-objectives",
    "href": "pages/00_reminders.html#course-objectives",
    "title": "Introduction and Reminders",
    "section": "Course objectives",
    "text": "Course objectives\n\n\nArtwork by @allison_horst",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#kahoot",
    "href": "pages/00_reminders.html#kahoot",
    "title": "Introduction and Reminders",
    "section": "Kahoot",
    "text": "Kahoot",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-package-installation",
    "href": "pages/00_reminders.html#reminder-package-installation",
    "title": "Introduction and Reminders",
    "section": "Reminder: package installation",
    "text": "Reminder: package installation\nWhat’s your favorite method?\n\nRstudio wizard\ninstall.packages\nBiocManager::install\nremotes::install_github\npak::pak\nOther?",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-data-import",
    "href": "pages/00_reminders.html#reminder-data-import",
    "title": "Introduction and Reminders",
    "section": "Reminder: data import",
    "text": "Reminder: data import\nWhat’s your favorite method/package?\n\nRstudio wizard\nopenxlsx\nreadxl\nread.table\nOther?",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-dplyr-cheatsheet-recto",
    "href": "pages/00_reminders.html#reminder-dplyr-cheatsheet-recto",
    "title": "Introduction and Reminders",
    "section": "Reminder: dplyr (cheatsheet, recto)",
    "text": "Reminder: dplyr (cheatsheet, recto)",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-dplyr-cheatsheet-verso",
    "href": "pages/00_reminders.html#reminder-dplyr-cheatsheet-verso",
    "title": "Introduction and Reminders",
    "section": "Reminder: dplyr (cheatsheet, verso)",
    "text": "Reminder: dplyr (cheatsheet, verso)",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#useful-dplyr-functions",
    "href": "pages/00_reminders.html#useful-dplyr-functions",
    "title": "Introduction and Reminders",
    "section": "Useful dplyr functions",
    "text": "Useful dplyr functions\n\nselect: select variables\nfilter: filter observations\nmutate: add, modify, variables\ngroup_by: create groups\nsummarize: compute summary statistics (on groups)",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-ggplot2-cheasheet-recto",
    "href": "pages/00_reminders.html#reminder-ggplot2-cheasheet-recto",
    "title": "Introduction and Reminders",
    "section": "Reminder: ggplot2 (cheasheet recto)",
    "text": "Reminder: ggplot2 (cheasheet recto)",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-ggplot2-cheasheet-verso",
    "href": "pages/00_reminders.html#reminder-ggplot2-cheasheet-verso",
    "title": "Introduction and Reminders",
    "section": "Reminder: ggplot2 (cheasheet verso)",
    "text": "Reminder: ggplot2 (cheasheet verso)",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/00_reminders.html#reminder-as-an-exercise",
    "href": "pages/00_reminders.html#reminder-as-an-exercise",
    "title": "Introduction and Reminders",
    "section": "Reminder as an exercise",
    "text": "Reminder as an exercise\n\n\nWith the example dataset example1.csv, recreate the plot on the right.",
    "crumbs": [
      "Introduction and reminders"
    ]
  },
  {
    "objectID": "pages/02_gt.html#dimensions",
    "href": "pages/02_gt.html#dimensions",
    "title": "Great Tables",
    "section": "Dimensions",
    "text": "Dimensions\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nObject\n\n\nDimensions\n\n\nProperties\n\n\n\n\n\n\nvector\n\n\n1\n\n\nGeneral\n\n\n\n\nfactor\n\n\n1\n\n\nCategorical data\n\n\n\n\nlist\n\n\n1 ?\n\n\nAnything\n\n\n\n\nfunction\n\n\nNo\n\n\nComputes\n\n\n\n\nmatrix\n\n\n2\n\n\nOnly one type of data\n\n\n\n\ndata-frame\n\n\n2\n\n\nOne type per column\n\n\n\n\ntibble\n\n\n2\n\n\nid.\n\n\n\n\narray\n\n\n\\([1, +\\infty[\\)\n\n\nOnly one type of data",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/02_gt.html#printing-tabular-data",
    "href": "pages/02_gt.html#printing-tabular-data",
    "title": "Great Tables",
    "section": "Printing tabular data",
    "text": "Printing tabular data\nEach object has a print function:\n\nin the console,\nin a document….\n\nShort exercise: imagine what the components of a table are?",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/02_gt.html#great-tables",
    "href": "pages/02_gt.html#great-tables",
    "title": "Great Tables",
    "section": "Great tables",
    "text": "Great tables\n\nSource: https://gt.rstudio.com/",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/02_gt.html#simulated-example",
    "href": "pages/02_gt.html#simulated-example",
    "title": "Great Tables",
    "section": "Simulated example",
    "text": "Simulated example\n\nset.seed(73)\ndat.ex &lt;- tibble(\n  x = rnorm(100),\n  f = gl(n = 2, k = 50, labels = c(\"A\", \"B\")),\n  y = -5*x + 10*as.numeric(f) + rnorm(100)\n)",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/02_gt.html#using-gt-with-gtsummary",
    "href": "pages/02_gt.html#using-gt-with-gtsummary",
    "title": "Great Tables",
    "section": "Using gt with gtsummary",
    "text": "Using gt with gtsummary\n\n\n\ntbl_summary(dat.ex, by = f)\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nA\nN = 501\nB\nN = 501\n\n\n\n\nx\n0·38 (-0·37 – 1·09)\n-0·42 (-1·27 – 0·58)\n\n\ny\n8 (4 – 11)\n22 (17 – 26)\n\n\n\n1 Median (IQR)\n\n\n\n\n\n\n\n\n\n\n\n\ntbl_regression(\n  lm(y ~ x * f,\n     data = dat.ex))\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nBeta\n95% CI\np-value\n\n\n\n\nx\n-4·9\n-5·2 to -4·7\n&lt;0·0001\n\n\nf\n\n\n\n\n\n\n\n\n    A\n—\n—\n\n\n\n\n    B\n10\n9·6 to 10\n&lt;0·0001\n\n\nx * f\n\n\n\n\n\n\n\n\n    x * B\n-0·03\n-0·38 to 0·32\n0·88\n\n\n\nAbbreviation: CI = Confidence Interval",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/02_gt.html#exercise-level-1",
    "href": "pages/02_gt.html#exercise-level-1",
    "title": "Great Tables",
    "section": "Exercise level 1",
    "text": "Exercise level 1\n\nCreate your own toy dataset.\nUse gt and/or gtsummary to create tables on your toy dataset.\nCreate a short R Markdown report with your data, a plot, and a beautiful table.",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/02_gt.html#level-up",
    "href": "pages/02_gt.html#level-up",
    "title": "Great Tables",
    "section": "Level Up!",
    "text": "Level Up!\nNow, you are ready to include a Great Table in your R Markdown report on the COVID data.",
    "crumbs": [
      "(Great) Tables"
    ]
  },
  {
    "objectID": "pages/about.html",
    "href": "pages/about.html",
    "title": "About",
    "section": "",
    "text": "Amaury et Vincent\nWe are engineers at the Hub of Bioinformatics and Biostatistics. Link\nPlease check the schedule for the Open Desk, every Tuesday mornings. Link\n\n\nWe must thank…\n\nSTA120, for inspiring us a lot with their beautiful website!\n…",
    "crumbs": [
      "About"
    ]
  }
]